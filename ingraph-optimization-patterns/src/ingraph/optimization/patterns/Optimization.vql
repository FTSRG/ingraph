package ingraph.optimization.patterns

import "http://www.example.org/relalg";

// 1st transformation
pattern expandVertex(parentOperator : Operator, getVerticesOperator : GetVerticesOperator, expandOperator : ExpandOperator) {
	find parentOperator(parentOperator, expandOperator);
	ExpandOperator.input(expandOperator, getVerticesOperator);
	GetVerticesOperator(getVerticesOperator);
}

pattern parentOperator(parentOperator : Operator, operator : Operator) {
	AlphaOperator.input(parentOperator, operator);
} or {
	BetaOperator.leftInput(parentOperator, operator);
} or {
	BetaOperator.rightInput(parentOperator, operator);
}

// 2nd transformation
pattern expandOperator(expandOperator : ExpandOperator) {
	ExpandOperator(expandOperator);
}
